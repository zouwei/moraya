# v0.8.0 AI å¼•å¯¼æ¨¡æ¿ç³»ç»Ÿ

> è¿­ä»£ç‰ˆæœ¬: v0.8.0
> ä¸Šä¸€ç‰ˆæœ¬: v0.6.0
> åˆ›å»ºæ—¥æœŸ: 2026-02-12
> çŠ¶æ€: âœ… å·²å®Œæˆ

---

## ç‰ˆæœ¬æ¦‚è¦

å°† Moraya çš„ AI äº¤äº’ä»ç¡¬ç¼–ç çš„ 10 ä¸ªå¿«æ·å‘½ä»¤å‡çº§ä¸º**é…ç½®é©±åŠ¨çš„æ¨¡æ¿ç³»ç»Ÿ**ã€‚å†…ç½® 10 å¤§åˆ†ç±»ã€71+ ä¸ªäº¤äº’æ¨¡æ¿ï¼Œè¦†ç›–å†™ä½œã€ç¿»è¯‘ã€å­¦ä¹ ã€æ¸¸æˆã€åˆ·é¢˜ç­‰åœºæ™¯ã€‚æ ¸å¿ƒè®¾è®¡åŸåˆ™ï¼š

- **é…ç½®åŒ–**: æ‰€æœ‰æ¨¡æ¿ä»¥ JSON å®šä¹‰ï¼Œæ–°å¢æ¨¡æ¿é›¶ä»£ç 
- **å¯æ‰©å±•**: 5 ç§äº¤äº’æµç¨‹è¦†ç›–æ‰€æœ‰ AI å¯¹è¯æ¨¡å¼
- **è½»é‡çº§**: ä»… ~37KB å¢é‡ï¼ˆå…¶ä¸­ ~15KB ä¸º JSON é…ç½®ï¼‰
- **å¤šè¯­è¨€**: å…¨éƒ¨ç”¨æˆ·å¯è§æ–‡æœ¬é€šè¿‡ i18n key å›½é™…åŒ–ï¼ˆä¸­æ–‡ / è‹±æ–‡ï¼‰

---

## éœ€æ±‚èƒŒæ™¯

### å½“å‰é—®é¢˜

1. **å¿«æ·å‘½ä»¤æœ‰é™**: ä»… 10 ä¸ªç¡¬ç¼–ç å‘½ä»¤ï¼ˆ`write`, `continue`, `summarize` ç­‰ï¼‰ï¼Œæ— æ³•è¦†ç›–å¤šæ ·åŒ–ä½¿ç”¨åœºæ™¯
2. **ç©ºæ¶ˆæ¯ Bug**: æ¬¢è¿é¡µ 4 ä¸ªå¿«æ·æŒ‰é’®ä¸­ 3 ä¸ªï¼ˆ`write`, `summarize`, `translate`ï¼‰åœ¨æ— æ–‡æœ¬å†…å®¹æ—¶å‘é€ç©ºæ¶ˆæ¯ï¼ŒAPI æŠ¥é”™ `"messages.0: user messages must have non-empty content"`
3. **æ‰©å±•å›°éš¾**: æ–°å¢å‘½ä»¤éœ€ä¿®æ”¹ `types.ts`ã€`ai-service.ts`ã€`AIChatPanel.svelte` ä¸‰ä¸ªæ–‡ä»¶
4. **æ— äº¤äº’å¼•å¯¼**: ç¼ºä¹å‚æ•°é…ç½®ã€å¤šè½®å¯¹è¯ç­‰ä¸°å¯Œäº¤äº’æ¨¡å¼

### ç›®æ ‡

- ç”¨æˆ·æ‰“å¼€ AI é¢æ¿å³å¯çœ‹åˆ°åˆ†ç±»æ¨¡æ¿ç”»å»Šï¼Œç‚¹å‡»å³ç”¨
- æ”¯æŒå†™ä½œè¾…åŠ©ã€ç¿»è¯‘ã€å­¦ä¹ å¯è’™ã€æ–‡å­—æ¸¸æˆã€åˆ·é¢˜ç»ƒä¹ ç­‰ä¸°å¯Œåœºæ™¯
- æ¨¡æ¿é€šè¿‡ JSON é…ç½®å£°æ˜ï¼Œåç»­æ‰©å±•ä»…éœ€æ·»åŠ  JSON æ¡ç›®
- å¯¹ç°æœ‰æ¶æ„æ”¹åŠ¨æœ€å°ï¼ˆå¤ç”¨ `sendChatMessage` / `executeAICommand` åŸºç¡€è®¾æ–½ï¼‰

---

## å…³é”®å†³ç­–

| å†³ç­–é¡¹ | é€‰æ‹© | ç†ç”± |
|--------|------|------|
| æ¨¡æ¿å®šä¹‰æ ¼å¼ | TypeScript å†…è” JSON | ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ï¼Œæ— è¿è¡Œæ—¶ IOï¼Œæ‰“åŒ…å gzip æå° |
| äº¤äº’æµç¨‹ | 5 ç§ FlowType æšä¸¾ | è¦†ç›–æ‰€æœ‰åœºæ™¯ï¼šè‡ªåŠ¨/è¾“å…¥/é€‰æ‹©/å‚æ•°åŒ–/å¤šè½® |
| Prompt æ¨¡æ¿ | åŒèŠ±æ‹¬å·æ’å€¼ `{{var}}` | ç®€å•ç›´è§‚ï¼Œæ— éœ€å¼•å…¥æ¨¡æ¿å¼•æ“åº“ |
| i18n ç­–ç•¥ | nameKey/descKey å¼•ç”¨ i18n JSON | å¤ç”¨ç°æœ‰ i18n ç³»ç»Ÿï¼Œé›¶é¢å¤–ä¾èµ– |
| UI å…¥å£ | æ›¿æ¢æ¬¢è¿é¡µå¿«æ·æŒ‰é’® â†’ æ¨¡æ¿ç”»å»Š | æœ€å° UI æ”¹åŠ¨ï¼Œç”¨æˆ·é›¶å­¦ä¹ æˆæœ¬ |
| å‘åå…¼å®¹ | ä¿ç•™åŸæœ‰ `/` å‘½ä»¤é¢æ¿ | ç†Ÿç»ƒç”¨æˆ·ä»å¯ç”¨ `/write`ã€`/translate` ç­‰å¿«æ·æ–¹å¼ |

---

## äº¤äº’æµç¨‹ç±»å‹

### 5 ç§ FlowType

| FlowType | åç§° | è¯´æ˜ | ç¤ºä¾‹ |
|----------|------|------|------|
| `auto` | è‡ªåŠ¨æ‰§è¡Œ | è·å–ç¼–è¾‘å™¨å†…å®¹åç›´æ¥å‘é€ï¼Œæ— éœ€ç”¨æˆ·é¢å¤–è¾“å…¥ | ç»§ç»­å†™ä½œã€æ€»ç»“ã€è¯­æ³•ä¿®å¤ |
| `input` | æ–‡æœ¬è¾“å…¥ | å¼¹å‡ºè¾“å…¥æ¡†è®©ç”¨æˆ·æä¾›è‡ªå®šä¹‰å†…å®¹åå‘é€ | è‡ªç”±å†™ä½œã€å¤§çº²ç”Ÿæˆ |
| `selection` | é€‰é¡¹é€‰æ‹© | å±•ç¤ºé¢„å®šä¹‰é€‰é¡¹è®©ç”¨æˆ·é€‰æ‹©åå‘é€ | ç¿»è¯‘ç›®æ ‡è¯­è¨€ã€æ”¹å†™é£æ ¼ |
| `parameterized` | å‚æ•°é…ç½® | å±•ç¤ºå¤šä¸ªå‚æ•°é¢æ¿ï¼ˆä¸‹æ‹‰æ¡†/å•é€‰ï¼‰è®©ç”¨æˆ·é…ç½®åå‘é€ | AIGC å›¾ç‰‡é…ç½®ã€åˆ·é¢˜æ–¹å‘+éš¾åº¦ |
| `interactive` | å¤šè½®å¯¹è¯ | å‘é€åˆå§‹ prompt åè¿›å…¥è‡ªç”±å¯¹è¯æ¨¡å¼ | æ–‡å­—æ¸¸æˆï¼ˆé£èŠ±ä»¤ã€æˆè¯­æ¥é¾™ï¼‰ã€è§’è‰²æ‰®æ¼” |

### æµç¨‹å›¾

```
ç”¨æˆ·ç‚¹å‡»æ¨¡æ¿
    â”‚
    â”œâ”€â”€ auto â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> è·å– content/selection â†’ æ’å€¼ prompt â†’ å‘é€ AI
    â”‚
    â”œâ”€â”€ input â”€â”€â”€â”€â”€â”€â”€â”€â”€> æ˜¾ç¤ºè¾“å…¥æ¡† â†’ ç”¨æˆ·è¾“å…¥ â†’ æ’å€¼ prompt â†’ å‘é€ AI
    â”‚
    â”œâ”€â”€ selection â”€â”€â”€â”€â”€> æ˜¾ç¤ºé€‰é¡¹åˆ—è¡¨ â†’ ç”¨æˆ·é€‰æ‹© â†’ æ’å€¼ prompt â†’ å‘é€ AI
    â”‚
    â”œâ”€â”€ parameterized â”€> æ˜¾ç¤ºå‚æ•°é¢æ¿ â†’ ç”¨æˆ·é…ç½® â†’ æ’å€¼ prompt â†’ å‘é€ AI
    â”‚
    â””â”€â”€ interactive â”€â”€â”€> æ’å€¼åˆå§‹ prompt â†’ å‘é€ AI â†’ è¿›å…¥è‡ªç”±å¯¹è¯æ¨¡å¼
                                                      â†• (å¤šè½®æ¥å›)
```

---

## æ¨¡æ¿åˆ†ç±»ä¸å®Œæ•´åˆ—è¡¨

### åˆ†ç±»ä¸€è§ˆ

| # | åˆ†ç±» ID | å›¾æ ‡ | ä¸­æ–‡å | è‹±æ–‡å | æ¨¡æ¿æ•° |
|---|---------|------|--------|--------|--------|
| 1 | `writing` | âœ | å†™ä½œè¾…åŠ© | Writing | 8 |
| 2 | `translation` | ğŸŒ | ç¿»è¯‘ | Translation | 5 |
| 3 | `student` | ğŸ“š | å­¦ä¹ åŠ©æ‰‹ | Student | 8 |
| 4 | `kids` | ğŸŒˆ | å°‘å„¿å¯è’™ | Kids | 8 |
| 5 | `marketing` | ğŸ“¢ | è¥é”€æ–‡æ¡ˆ | Marketing | 6 |
| 6 | `professional` | ğŸ’¼ | èŒåœºåŠå…¬ | Professional | 6 |
| 7 | `personal` | ğŸŒ± | ä¸ªäººæˆé•¿ | Personal | 5 |
| 8 | `games_cn` | ğŸ² | ä¸­æ–‡æ¸¸æˆ | Chinese Games | 12 |
| 9 | `games_en` | ğŸ¯ | è‹±æ–‡æ¸¸æˆ | English Games | 12 |
| 10 | `quiz` | ğŸ§  | åˆ·é¢˜ç»ƒä¹  | Quiz & Practice | 1ï¼ˆä¸‡èƒ½ï¼‰ |
| | | | **åˆè®¡** | | **71** |

---

### 1. å†™ä½œè¾…åŠ© (writing)

| æ¨¡æ¿ ID | åç§° | Flow | Content Source | è¯´æ˜ |
|---------|------|------|---------------|------|
| `writing.free` | è‡ªç”±å†™ä½œ | input | none | ç”¨æˆ·è¾“å…¥ä¸»é¢˜ï¼ŒAI ç”Ÿæˆæ–‡ç«  |
| `writing.continue` | ç»§ç»­å†™ä½œ | auto | document | ä»å½“å‰æ–‡æ¡£æœ«å°¾ç»­å†™ |
| `writing.outline` | ç”Ÿæˆå¤§çº² | input | none | è¾“å…¥ä¸»é¢˜ï¼Œç”Ÿæˆæ–‡ç« å¤§çº² |
| `writing.summarize` | æ€»ç»“æ¦‚æ‹¬ | auto | document_or_selection | æ€»ç»“é€‰ä¸­æ–‡æœ¬æˆ–å…¨æ–‡ |
| `writing.improve` | æ¶¦è‰²ä¼˜åŒ– | auto | selection | æå‡é€‰ä¸­æ–‡æœ¬è´¨é‡ |
| `writing.simplify` | ç®€åŒ–è¡¨è¾¾ | auto | selection | å°†å¤æ‚æ–‡æœ¬ç®€åŒ– |
| `writing.expand` | æ‰©å±•å†…å®¹ | auto | selection | å¯¹é€‰ä¸­å†…å®¹è¿›è¡Œæ‰©å±• |
| `writing.fix_grammar` | è¯­æ³•ä¿®æ­£ | auto | selection | ä¿®å¤è¯­æ³•å’Œæ‹¼å†™é”™è¯¯ |

### 2. ç¿»è¯‘ (translation)

| æ¨¡æ¿ ID | åç§° | Flow | Content Source | è¯´æ˜ |
|---------|------|------|---------------|------|
| `translation.auto` | æ™ºèƒ½ç¿»è¯‘ | auto | selection | è‡ªåŠ¨æ£€æµ‹è¯­è¨€å¹¶ç¿»è¯‘ï¼ˆä¸­â†”è‹±ï¼‰ |
| `translation.to_target` | æŒ‡å®šè¯­è¨€ç¿»è¯‘ | selection | selection | é€‰æ‹©ç›®æ ‡è¯­è¨€åç¿»è¯‘ |
| `translation.explain` | ç¿»è¯‘å¹¶è§£é‡Š | auto | selection | ç¿»è¯‘ + é€å¥è§£é‡Šç”¨è¯ |
| `translation.polish` | æœ¬åœ°åŒ–æ¶¦è‰² | auto | selection | ä½¿ç¿»è¯‘æ›´åœ°é“è‡ªç„¶ |
| `translation.compare` | å¤šç‰ˆæœ¬ç¿»è¯‘ | auto | selection | æä¾› 3 ä¸ªä¸åŒé£æ ¼è¯‘æœ¬ |

`translation.to_target` é€‰é¡¹åˆ—è¡¨ï¼š

```json
{
  "params": [{
    "key": "targetLang",
    "type": "select",
    "options": [
      { "value": "en", "labelKey": "templates.translation.lang.en" },
      { "value": "zh-CN", "labelKey": "templates.translation.lang.zhCN" },
      { "value": "ja", "labelKey": "templates.translation.lang.ja" },
      { "value": "ko", "labelKey": "templates.translation.lang.ko" },
      { "value": "fr", "labelKey": "templates.translation.lang.fr" },
      { "value": "de", "labelKey": "templates.translation.lang.de" },
      { "value": "es", "labelKey": "templates.translation.lang.es" }
    ]
  }]
}
```

### 3. å­¦ä¹ åŠ©æ‰‹ (student)

| æ¨¡æ¿ ID | åç§° | Flow | Content Source | è¯´æ˜ |
|---------|------|------|---------------|------|
| `student.explain` | æ¦‚å¿µè§£é‡Š | input | none | è¾“å…¥æ¦‚å¿µï¼ŒAI ç”¨é€šä¿—è¯­è¨€è§£é‡Š |
| `student.notes` | å­¦ä¹ ç¬”è®° | auto | selection | å°†é€‰ä¸­å†…å®¹æ•´ç†æˆç»“æ„åŒ–ç¬”è®° |
| `student.flashcard` | çŸ¥è¯†å¡ç‰‡ | auto | selection | ä»å†…å®¹ä¸­æå– Q&A é—ªå¡ |
| `student.mindmap` | æ€ç»´å¯¼å›¾ | auto | document_or_selection | ç”Ÿæˆ Markdown æ ¼å¼æ€ç»´å¯¼å›¾ |
| `student.essay_outline` | ä½œæ–‡æçº² | input | none | è¾“å…¥é¢˜ç›®ï¼Œç”Ÿæˆä½œæ–‡æçº² |
| `student.reading` | é˜…è¯»ç†è§£ | auto | selection | å¯¹é€‰ä¸­æ–‡æœ¬è¿›è¡Œæ·±åº¦åˆ†æ |
| `student.formula` | å…¬å¼æ¨å¯¼ | input | none | è¾“å…¥å…¬å¼åç§°ï¼Œç»™å‡ºæ¨å¯¼è¿‡ç¨‹ï¼ˆLaTeXï¼‰ |
| `student.compare` | çŸ¥è¯†å¯¹æ¯” | input | none | è¾“å…¥ä¸¤ä¸ªæ¦‚å¿µï¼Œè¡¨æ ¼å¯¹æ¯”å¼‚åŒ |

### 4. å°‘å„¿å¯è’™ (kids)

| æ¨¡æ¿ ID | åç§° | Flow | Content Source | è¯´æ˜ |
|---------|------|------|---------------|------|
| `kids.story` | å„¿ç«¥æ•…äº‹ | input | none | è¾“å…¥å…³é”®è¯ç”Ÿæˆå„¿ç«¥æ•…äº‹ |
| `kids.poem` | å„¿æ­Œç«¥è°£ | input | none | æ ¹æ®ä¸»é¢˜ç¼–å†™å„¿æ­Œ |
| `kids.why` | åä¸‡ä¸ªä¸ºä»€ä¹ˆ | interactive | none | AI å›ç­”ä¸€ä¸ªåˆä¸€ä¸ª"ä¸ºä»€ä¹ˆ" |
| `kids.alphabet` | å­—æ¯å­¦ä¹  | interactive | none | äº¤äº’å¼å­—æ¯/æ‹¼éŸ³æ•™å­¦ |
| `kids.math_game` | è¶£å‘³ç®—æœ¯ | interactive | none | å‡ºé¢˜ â†’ å›ç­” â†’ è¯„åˆ†å¾ªç¯ |
| `kids.riddle` | çŒœè°œè¯­ | interactive | none | AI å‡ºè°œè¯­ï¼Œå°æœ‹å‹çŒœç­”æ¡ˆ |
| `kids.draw_text` | çœ‹å›¾è¯´è¯ | input | none | æè¿°ä¸€ä¸ªåœºæ™¯ï¼ŒAI ç¼–æ•…äº‹ |
| `kids.knowledge` | ç™¾ç§‘é—®ç­” | interactive | none | è‡ªç„¶/ç§‘å­¦/åŠ¨ç‰©ç™¾ç§‘äº’åŠ¨ |

### 5. è¥é”€æ–‡æ¡ˆ (marketing)

| æ¨¡æ¿ ID | åç§° | Flow | Content Source | è¯´æ˜ |
|---------|------|------|---------------|------|
| `marketing.xiaohongshu` | å°çº¢ä¹¦æ–‡æ¡ˆ | input | none | ç”Ÿæˆå°çº¢ä¹¦é£æ ¼ç§è‰æ–‡æ¡ˆ |
| `marketing.twitter` | Twitter/X å¸–å­ | input | none | ç”Ÿæˆæ¨ç‰¹é£æ ¼çŸ­æ–‡æ¡ˆ |
| `marketing.slogan` | å¹¿å‘Šæ ‡è¯­ | input | none | ä¸ºå“ç‰Œ/äº§å“ç”Ÿæˆæ ‡è¯­ |
| `marketing.email` | è¥é”€é‚®ä»¶ | parameterized | none | é…ç½®äº§å“+ç›®æ ‡äººç¾¤+è¯­æ°” |
| `marketing.seo_article` | SEO æ–‡ç«  | input | none | æ ¹æ®å…³é”®è¯ç”Ÿæˆ SEO ä¼˜åŒ–æ–‡ç«  |
| `marketing.product_desc` | äº§å“æè¿° | input | none | ä¸ºäº§å“ç”Ÿæˆå¸å¼•åŠ›æè¿°æ–‡æ¡ˆ |

### 6. èŒåœºåŠå…¬ (professional)

| æ¨¡æ¿ ID | åç§° | Flow | Content Source | è¯´æ˜ |
|---------|------|------|---------------|------|
| `professional.email` | å•†åŠ¡é‚®ä»¶ | parameterized | none | é…ç½®åœºæ™¯+è¯­æ°”+è¦ç‚¹ |
| `professional.meeting` | ä¼šè®®çºªè¦ | auto | selection | å°†åŸå§‹ç¬”è®°æ•´ç†æˆæ­£å¼çºªè¦ |
| `professional.report` | å·¥ä½œæŠ¥å‘Š | parameterized | none | å‘¨æŠ¥/æœˆæŠ¥/å­£æŠ¥æ¨¡æ¿ |
| `professional.review` | ä»£ç å®¡æŸ¥ | auto | selection | å®¡æŸ¥é€‰ä¸­ä»£ç å¹¶æå‡ºå»ºè®® |
| `professional.resume` | ç®€å†ä¼˜åŒ– | auto | selection | ä¼˜åŒ–ç®€å†æè¿°ï¼ˆSTAR æ³•åˆ™ï¼‰ |
| `professional.prd` | PRD æ–‡æ¡£ | input | none | è¾“å…¥åŠŸèƒ½æè¿°ï¼Œç”Ÿæˆ PRD |

### 7. ä¸ªäººæˆé•¿ (personal)

| æ¨¡æ¿ ID | åç§° | Flow | Content Source | è¯´æ˜ |
|---------|------|------|---------------|------|
| `personal.journal` | æ—¥è®°åŠ©æ‰‹ | input | none | å¼•å¯¼å†™æ—¥è®°/åæ€ |
| `personal.goal` | ç›®æ ‡åˆ†è§£ | input | none | å°†å¤§ç›®æ ‡åˆ†è§£ä¸ºå¯æ‰§è¡Œæ­¥éª¤ |
| `personal.habit` | ä¹ æƒ¯å…»æˆ | input | none | åˆ¶å®šä¹ æƒ¯å…»æˆè®¡åˆ’ |
| `personal.decision` | å†³ç­–åˆ†æ | input | none | åˆ©å¼Šåˆ†æå¸®åŠ©åšå†³å®š |
| `personal.book_notes` | è¯»ä¹¦ç¬”è®° | auto | selection | æ•´ç†é€‰ä¸­å†…å®¹ä¸ºè¯»ä¹¦ç¬”è®° |

### 8. ä¸­æ–‡æ¸¸æˆ (games_cn)

| æ¨¡æ¿ ID | åç§° | Flow | è¯´æ˜ |
|---------|------|------|------|
| `games_cn.feihualing` | é£èŠ±ä»¤ | interactive | åŒæ–¹è½®æµè¯´å«æŒ‡å®šå­—çš„è¯—å¥ |
| `games_cn.chengyu_chain` | æˆè¯­æ¥é¾™ | interactive | æœ«å­—æ¥é¦–å­—çš„æˆè¯­æ¥é¾™ |
| `games_cn.riddle` | çŒœè°œè¯­ | interactive | AI å‡ºè°œé¢ï¼Œç”¨æˆ·çŒœè°œåº• |
| `games_cn.lantern_riddle` | çŒœç¯è°œ | interactive | ç¯è°œç‰¹æ®Šè§„åˆ™ï¼ˆå­—è°œã€æ‹†å­—ï¼‰ |
| `games_cn.poetry_fill` | è¯—è¯å¡«ç©º | interactive | ç»™å‡ºè¯—å¥ç•™ç©ºï¼Œè€ƒå¯Ÿè®°å¿† |
| `games_cn.story_chain` | æ•…äº‹æ¥é¾™ | interactive | åŒæ–¹äº¤æ›¿ç»­å†™æ•…äº‹ |
| `games_cn.character_game` | çŒœå­—æ¸¸æˆ | interactive | æè¿°æ±‰å­—ï¼ŒçŒœæ˜¯å“ªä¸ªå­— |
| `games_cn.brain_teaser` | è„‘ç­‹æ€¥è½¬å¼¯ | interactive | è¶£å‘³è„‘ç­‹æ€¥è½¬å¼¯ |
| `games_cn.couplet` | å¯¹è” | interactive | AI å‡ºä¸Šè”ï¼Œç”¨æˆ·å¯¹ä¸‹è” |
| `games_cn.word_explain` | ä½ è¯´æˆ‘çŒœ | interactive | AI æè¿°è¯è¯­ï¼Œç”¨æˆ·çŒœè¯ |
| `games_cn.ancient_text` | æ–‡è¨€æ–‡ç¿»è¯‘æŒ‘æˆ˜ | interactive | AI å‡ºæ–‡è¨€æ–‡ï¼Œç”¨æˆ·ç¿»è¯‘ç™½è¯æ–‡ |
| `games_cn.homophone` | è°éŸ³æ¢— | interactive | è°éŸ³åŒå…³åˆ›æ„æŒ‘æˆ˜ |

### 9. è‹±æ–‡æ¸¸æˆ (games_en)

| æ¨¡æ¿ ID | åç§° | Flow | è¯´æ˜ |
|---------|------|------|------|
| `games_en.word_chain` | Word Chain | interactive | æœ«å­—æ¯æ¥é¦–å­—æ¯ï¼ˆå¦‚ apple â†’ elephantï¼‰ |
| `games_en.twenty_questions` | 20 Questions | interactive | 20 ä¸ªæ˜¯/å¦é—®é¢˜çŒœç‰©å“ |
| `games_en.hangman` | Hangman | interactive | çŒœå­—æ¯æ‹¼å•è¯ï¼ˆæ–‡å­—ç‰ˆ hangmanï¼‰ |
| `games_en.story_builder` | Story Builder | interactive | æ¯äººä¸€å¥ï¼Œå…±åˆ›æ•…äº‹ |
| `games_en.word_association` | Word Association | interactive | è‡ªç”±è¯æ±‡è”æƒ³æ¥é¾™ |
| `games_en.riddles` | Riddles | interactive | è‹±æ–‡è°œè¯­ |
| `games_en.trivia` | Trivia Quiz | interactive | å¸¸è¯†é—®ç­” |
| `games_en.rhyme_time` | Rhyme Time | interactive | ç”¨æŠ¼éŸµè¯ç¼–æ•…äº‹ |
| `games_en.acronym` | Acronym Game | interactive | ä¸ºéšæœºé¦–å­—æ¯ç¼©å†™ç¼–å«ä¹‰ |
| `games_en.taboo` | Taboo | interactive | ä¸èƒ½ç”¨ç‰¹å®šè¯æ¥æè¿°ç›®æ ‡è¯ |
| `games_en.sentence_builder` | Sentence Builder | interactive | ç”¨æŒ‡å®šè¯é€ æœ€é•¿å¥ |
| `games_en.emoji_story` | Emoji Story | interactive | ç”¨ emoji è¡¨è¾¾å¥å­è®©å¯¹æ–¹çŒœ |

### 10. åˆ·é¢˜ç»ƒä¹  (quiz)

| æ¨¡æ¿ ID | åç§° | Flow | è¯´æ˜ |
|---------|------|------|------|
| `quiz.practice` | ä¸‡èƒ½åˆ·é¢˜ | parameterized + interactive | é€‰æ‹©æ–¹å‘+éš¾åº¦ â†’ AI å‡ºé¢˜ â†’ ç”¨æˆ·ç­”é¢˜ â†’ AI è¯„åˆ¤ â†’ å¾ªç¯ |

åˆ·é¢˜å‚æ•°é¢æ¿ï¼š

```json
{
  "params": [
    {
      "key": "direction",
      "type": "select",
      "labelKey": "templates.quiz.direction",
      "options": [
        { "value": "programming", "labelKey": "templates.quiz.dir.programming" },
        { "value": "math", "labelKey": "templates.quiz.dir.math" },
        { "value": "english", "labelKey": "templates.quiz.dir.english" },
        { "value": "science", "labelKey": "templates.quiz.dir.science" },
        { "value": "history", "labelKey": "templates.quiz.dir.history" },
        { "value": "interview", "labelKey": "templates.quiz.dir.interview" },
        { "value": "custom", "labelKey": "templates.quiz.dir.custom" }
      ]
    },
    {
      "key": "difficulty",
      "type": "radio",
      "labelKey": "templates.quiz.difficulty",
      "options": [
        { "value": "easy", "labelKey": "templates.quiz.diff.easy" },
        { "value": "medium", "labelKey": "templates.quiz.diff.medium" },
        { "value": "hard", "labelKey": "templates.quiz.diff.hard" }
      ]
    }
  ]
}
```

åˆ·é¢˜äº¤äº’æµç¨‹ï¼š

```
[ç”¨æˆ·é€‰æ‹©æ–¹å‘+éš¾åº¦] â†’ AI å‡ºç¬¬ 1 é¢˜
  â†’ ç”¨æˆ·æäº¤ç­”æ¡ˆ
  â†’ AI è¯„åˆ¤ï¼ˆâœ…/âŒ + æ­£ç¡®ç­”æ¡ˆ + è§£æï¼‰
  â†’ AI è‡ªåŠ¨å‡ºç¬¬ 2 é¢˜
  â†’ ... å¾ªç¯ç›´åˆ°ç”¨æˆ·é€€å‡º
```

---

## é¢†åŸŸæ¨¡å‹

### æ ¸å¿ƒç±»å‹å®šä¹‰

```typescript
// src/lib/services/ai/templates/types.ts

/** äº¤äº’æµç¨‹ç±»å‹ */
export type FlowType =
  | 'auto'           // è‡ªåŠ¨æ‰§è¡Œï¼šè·å–å†…å®¹ â†’ ç›´æ¥å‘é€
  | 'input'          // æ–‡æœ¬è¾“å…¥ï¼šå¼¹å‡ºè¾“å…¥æ¡† â†’ ç”¨æˆ·å¡«å†™ â†’ å‘é€
  | 'selection'      // é€‰é¡¹é€‰æ‹©ï¼šå±•ç¤ºé€‰é¡¹ â†’ ç”¨æˆ·é€‰ â†’ å‘é€
  | 'parameterized'  // å‚æ•°é…ç½®ï¼šå¤šå‚æ•°é¢æ¿ â†’ ç”¨æˆ·é…ç½® â†’ å‘é€
  | 'interactive';   // å¤šè½®å¯¹è¯ï¼šå‘é€åˆå§‹ prompt â†’ è¿›å…¥å¯¹è¯æ¨¡å¼

/** å†…å®¹æ¥æº */
export type ContentSource =
  | 'none'                   // æ— éœ€ç¼–è¾‘å™¨å†…å®¹
  | 'document'               // éœ€è¦å½“å‰æ–‡æ¡£å†…å®¹
  | 'selection'              // éœ€è¦é€‰ä¸­æ–‡æœ¬ï¼ˆæ— é€‰ä¸­åˆ™æç¤ºï¼‰
  | 'document_or_selection'; // ä¼˜å…ˆé€‰ä¸­æ–‡æœ¬ï¼Œå›é€€åˆ°æ–‡æ¡£å†…å®¹

/** AI å›å¤çš„æ“ä½œç±»å‹ */
export type ResultAction = 'insert' | 'replace' | 'copy' | 'none';

/** æ¨¡æ¿å‚æ•°é€‰é¡¹ */
export interface TemplateParamOption {
  value: string;
  labelKey: string;    // i18n key â†’ "ç®€å•" / "Easy"
}

/** æ¨¡æ¿å‚æ•°å®šä¹‰ */
export interface TemplateParam {
  key: string;                   // å‚æ•°æ ‡è¯†ï¼ˆç”¨äº prompt æ’å€¼ï¼‰
  labelKey: string;              // å‚æ•°æ ‡ç­¾ i18n key
  type: 'select' | 'radio';     // ä¸‹æ‹‰æ¡† or å•é€‰ç»„
  options: TemplateParamOption[];
  default: string;               // é»˜è®¤å€¼ï¼ˆoptions ä¸­æŸä¸ª valueï¼‰
}

/** AI æ¨¡æ¿å®šä¹‰ï¼ˆæ ¸å¿ƒé…ç½®ï¼‰ */
export interface AITemplate {
  id: string;                    // å”¯ä¸€æ ‡è¯† "category.name"
  category: string;              // åˆ†ç±» ID
  icon: string;                  // æ˜¾ç¤ºå›¾æ ‡ï¼ˆemojiï¼‰
  nameKey: string;               // åç§° i18n key
  descKey: string;               // æè¿° i18n key
  flow: FlowType;                // äº¤äº’æµç¨‹ç±»å‹
  contentSource: ContentSource;  // éœ€è¦çš„ç¼–è¾‘å™¨å†…å®¹ç±»å‹
  inputHintKey?: string;         // input ç±»å‹çš„å ä½æç¤º i18n key
  params?: TemplateParam[];      // parameterized/selection çš„å‚æ•°
  systemPrompt: string;          // System promptï¼ˆè‹±æ–‡ï¼ŒAI æ¶ˆè´¹ï¼‰
  userPromptTemplate: string;    // User prompt æ¨¡æ¿ï¼ˆæ”¯æŒ {{}} æ’å€¼ï¼‰
  defaultActions: ResultAction[];// å›å¤é»˜è®¤æ“ä½œæŒ‰é’®
  tags?: string[];               // æœç´¢æ ‡ç­¾
  sortOrder?: number;            // æ’åºæƒé‡
}

/** æ¨¡æ¿åˆ†ç±»å®šä¹‰ */
export interface AITemplateCategory {
  id: string;
  icon: string;
  nameKey: string;     // åˆ†ç±»åç§° i18n key
  descKey: string;     // åˆ†ç±»æè¿° i18n key
  sortOrder: number;
}
```

### Prompt æ’å€¼å˜é‡

| å˜é‡ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `{{content}}` | string | ç¼–è¾‘å™¨å†…å®¹ï¼ˆç”± contentSource å†³å®šæ¥æºï¼‰ |
| `{{input}}` | string | ç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¸­å¡«å†™çš„æ–‡æœ¬ |
| `{{param.xxx}}` | string | ç”¨æˆ·é€‰æ‹©çš„å‚æ•°å€¼ï¼ˆxxx = TemplateParam.keyï¼‰ |
| `{{locale}}` | string | å½“å‰è¯­è¨€ä»£ç ï¼ˆ`en` / `zh-CN`ï¼‰ |
| `{{paramLabel.xxx}}` | string | å‚æ•°å€¼å¯¹åº”çš„æœ¬åœ°åŒ–æ ‡ç­¾ |

### æ’å€¼å¼•æ“

```typescript
// src/lib/services/ai/templates/engine.ts

interface TemplateContext {
  content?: string;           // ç¼–è¾‘å™¨å†…å®¹
  input?: string;             // ç”¨æˆ·è¾“å…¥
  params?: Record<string, string>;       // å‚æ•°å€¼
  paramLabels?: Record<string, string>;  // å‚æ•°æ ‡ç­¾
  locale?: string;            // å½“å‰è¯­è¨€
}

/**
 * æ’å€¼æ¨¡æ¿å­—ç¬¦ä¸²ä¸­çš„ {{variable}} å ä½ç¬¦
 */
export function interpolate(template: string, ctx: TemplateContext): string {
  return template.replace(/\{\{(\w+(?:\.\w+)?)\}\}/g, (_, key: string) => {
    if (key === 'content') return ctx.content ?? '';
    if (key === 'input') return ctx.input ?? '';
    if (key === 'locale') return ctx.locale ?? 'en';
    if (key.startsWith('param.')) return ctx.params?.[key.slice(6)] ?? '';
    if (key.startsWith('paramLabel.')) return ctx.paramLabels?.[key.slice(11)] ?? '';
    return '';
  });
}
```

---

## æ¨¡æ¿é…ç½®ç¤ºä¾‹

### ç¤ºä¾‹ 1: auto ç±»å‹ï¼ˆç»§ç»­å†™ä½œï¼‰

```json
{
  "id": "writing.continue",
  "category": "writing",
  "icon": "â†’",
  "nameKey": "templates.writing.continue.name",
  "descKey": "templates.writing.continue.desc",
  "flow": "auto",
  "contentSource": "document",
  "systemPrompt": "Continue writing from where the text left off. Maintain the same style, tone, and format. Output in Markdown.",
  "userPromptTemplate": "Continue writing from this text:\n\n{{content}}",
  "defaultActions": ["insert", "copy"]
}
```

### ç¤ºä¾‹ 2: input ç±»å‹ï¼ˆè‡ªç”±å†™ä½œï¼‰

```json
{
  "id": "writing.free",
  "category": "writing",
  "icon": "âœ",
  "nameKey": "templates.writing.free.name",
  "descKey": "templates.writing.free.desc",
  "flow": "input",
  "contentSource": "none",
  "inputHintKey": "templates.writing.free.hint",
  "systemPrompt": "You are a helpful writing assistant. Write content based on the user's instructions. Output in Markdown format. Be concise and well-structured.",
  "userPromptTemplate": "{{input}}",
  "defaultActions": ["insert", "copy"]
}
```

### ç¤ºä¾‹ 3: selection ç±»å‹ï¼ˆæŒ‡å®šè¯­è¨€ç¿»è¯‘ï¼‰

```json
{
  "id": "translation.to_target",
  "category": "translation",
  "icon": "ğŸŒ",
  "nameKey": "templates.translation.toTarget.name",
  "descKey": "templates.translation.toTarget.desc",
  "flow": "selection",
  "contentSource": "selection",
  "params": [{
    "key": "targetLang",
    "labelKey": "templates.translation.targetLang",
    "type": "select",
    "options": [
      { "value": "en", "labelKey": "templates.translation.lang.en" },
      { "value": "zh-CN", "labelKey": "templates.translation.lang.zhCN" },
      { "value": "ja", "labelKey": "templates.translation.lang.ja" },
      { "value": "ko", "labelKey": "templates.translation.lang.ko" },
      { "value": "fr", "labelKey": "templates.translation.lang.fr" },
      { "value": "de", "labelKey": "templates.translation.lang.de" },
      { "value": "es", "labelKey": "templates.translation.lang.es" }
    ],
    "default": "en"
  }],
  "systemPrompt": "You are a professional translator. Translate the given text accurately to the target language. Maintain the original formatting and tone.",
  "userPromptTemplate": "Translate the following text to {{paramLabel.targetLang}}:\n\n{{content}}",
  "defaultActions": ["replace", "copy"]
}
```

### ç¤ºä¾‹ 4: parameterized ç±»å‹ï¼ˆä¸‡èƒ½åˆ·é¢˜ï¼‰

```json
{
  "id": "quiz.practice",
  "category": "quiz",
  "icon": "ğŸ§ ",
  "nameKey": "templates.quiz.practice.name",
  "descKey": "templates.quiz.practice.desc",
  "flow": "parameterized",
  "contentSource": "none",
  "params": [
    {
      "key": "direction",
      "labelKey": "templates.quiz.direction",
      "type": "select",
      "options": [
        { "value": "programming", "labelKey": "templates.quiz.dir.programming" },
        { "value": "math", "labelKey": "templates.quiz.dir.math" },
        { "value": "english", "labelKey": "templates.quiz.dir.english" },
        { "value": "science", "labelKey": "templates.quiz.dir.science" },
        { "value": "history", "labelKey": "templates.quiz.dir.history" },
        { "value": "interview", "labelKey": "templates.quiz.dir.interview" },
        { "value": "custom", "labelKey": "templates.quiz.dir.custom" }
      ],
      "default": "programming"
    },
    {
      "key": "difficulty",
      "labelKey": "templates.quiz.difficulty",
      "type": "radio",
      "options": [
        { "value": "easy", "labelKey": "templates.quiz.diff.easy" },
        { "value": "medium", "labelKey": "templates.quiz.diff.medium" },
        { "value": "hard", "labelKey": "templates.quiz.diff.hard" }
      ],
      "default": "medium"
    }
  ],
  "systemPrompt": "You are a quiz master. Generate questions one at a time in the specified subject and difficulty. After the user answers, evaluate their answer (mark âœ… or âŒ), provide the correct answer with explanation, then automatically present the next question. Keep a running score. Format questions clearly with numbering.",
  "userPromptTemplate": "I want to practice {{paramLabel.direction}} questions at {{paramLabel.difficulty}} difficulty. Please start with question #1. After I answer, tell me if I'm right or wrong, explain the correct answer, then give me the next question. Keep score.",
  "defaultActions": ["none"]
}
```

### ç¤ºä¾‹ 5: interactive ç±»å‹ï¼ˆé£èŠ±ä»¤ï¼‰

```json
{
  "id": "games_cn.feihualing",
  "category": "games_cn",
  "icon": "ğŸŒ¸",
  "nameKey": "templates.games_cn.feihualing.name",
  "descKey": "templates.games_cn.feihualing.desc",
  "flow": "interactive",
  "contentSource": "none",
  "systemPrompt": "ä½ æ˜¯é£èŠ±ä»¤æ¸¸æˆä¸»æŒäººã€‚è§„åˆ™ï¼šåŒæ–¹è½®æµè¯´å‡ºåŒ…å«æŒ‡å®šæ±‰å­—çš„å¤è¯—è¯åå¥ï¼ˆå¿…é¡»æ˜¯çœŸå®å­˜åœ¨çš„è¯—å¥ï¼‰ã€‚ä½ å…ˆéšæœºé€‰ä¸€ä¸ªå­—ä½œä¸ºä»¤å­—ï¼Œè¯´å‡ºç¬¬ä¸€å¥ã€‚ç­‰ç”¨æˆ·å›åº”ååˆ¤æ–­å¯¹é”™ï¼ˆæ˜¯å¦åŒ…å«ä»¤å­—ã€æ˜¯å¦çœŸå®è¯—å¥ï¼‰ã€‚å¦‚æœç”¨æˆ·ç­”å¯¹ç»§ç»­è½®æµï¼Œç­”é”™æ‰£åˆ†ã€‚æ¯ 5 è½®å¯æ¢ä¸€ä¸ªæ–°ä»¤å­—ã€‚æ˜¾ç¤ºå½“å‰æ¯”åˆ†ã€‚",
  "userPromptTemplate": "å¼€å§‹é£èŠ±ä»¤æ¸¸æˆï¼è¯·é€‰ä¸€ä¸ªä»¤å­—å¹¶è¯´ç¬¬ä¸€å¥è¯—ã€‚",
  "defaultActions": ["none"]
}
```

---

## i18n å›½é™…åŒ–è®¾è®¡

### i18n Key ç»“æ„

æ‰€æœ‰æ¨¡æ¿ç›¸å…³çš„ i18n key ä½äº `templates` å‘½åç©ºé—´ä¸‹ã€‚ç»“æ„çº¦å®šï¼š

```
templates.{category}.{templateShortName}.name   â€” æ¨¡æ¿åç§°
templates.{category}.{templateShortName}.desc   â€” æ¨¡æ¿æè¿°
templates.{category}.{templateShortName}.hint   â€” è¾“å…¥æç¤ºï¼ˆinput ç±»å‹ï¼‰
templates.{category}.name                       â€” åˆ†ç±»åç§°
templates.{category}.desc                       â€” åˆ†ç±»æè¿°
templates.{category}.{paramKey}                 â€” å‚æ•°æ ‡ç­¾
templates.{category}.{paramKey}.{optionValue}   â€” å‚æ•°é€‰é¡¹æ ‡ç­¾
```

### i18n æ¡ç›®ç¤ºä¾‹

#### ä¸­æ–‡ (zh-CN.json)

```json
{
  "templates": {
    "gallery": {
      "title": "AI åŠ©æ‰‹",
      "search": "æœç´¢æ¨¡æ¿...",
      "all": "å…¨éƒ¨",
      "back": "è¿”å›åˆ†ç±»"
    },
    "writing": {
      "name": "å†™ä½œè¾…åŠ©",
      "desc": "AI è¾…åŠ©å†™ä½œã€æ¶¦è‰²ã€æ€»ç»“",
      "free": {
        "name": "è‡ªç”±å†™ä½œ",
        "desc": "è¾“å…¥ä¸»é¢˜æˆ–è¦æ±‚ï¼ŒAI ä¸ºä½ ç”Ÿæˆæ–‡ç« ",
        "hint": "è¯·è¾“å…¥å†™ä½œä¸»é¢˜æˆ–è¦æ±‚..."
      },
      "continue": {
        "name": "ç»§ç»­å†™ä½œ",
        "desc": "ä»å½“å‰æ–‡æ¡£æœ«å°¾ç»­å†™"
      },
      "outline": {
        "name": "ç”Ÿæˆå¤§çº²",
        "desc": "è¾“å…¥ä¸»é¢˜ï¼Œç”Ÿæˆæ–‡ç« å¤§çº²",
        "hint": "è¯·è¾“å…¥æ–‡ç« ä¸»é¢˜..."
      },
      "summarize": {
        "name": "æ€»ç»“æ¦‚æ‹¬",
        "desc": "æ€»ç»“é€‰ä¸­æ–‡æœ¬æˆ–å…¨æ–‡è¦ç‚¹"
      },
      "improve": {
        "name": "æ¶¦è‰²ä¼˜åŒ–",
        "desc": "æå‡é€‰ä¸­æ–‡æœ¬çš„è¡¨è¾¾è´¨é‡"
      },
      "simplify": {
        "name": "ç®€åŒ–è¡¨è¾¾",
        "desc": "å°†å¤æ‚æ–‡æœ¬ç®€åŒ–ä¸ºæ˜“æ‡‚çš„è¯­è¨€"
      },
      "expand": {
        "name": "æ‰©å±•å†…å®¹",
        "desc": "å¯¹é€‰ä¸­å†…å®¹è¿›è¡Œè¡¥å……æ‰©å±•"
      },
      "fixGrammar": {
        "name": "è¯­æ³•ä¿®æ­£",
        "desc": "ä¿®å¤è¯­æ³•å’Œæ‹¼å†™é”™è¯¯"
      }
    },
    "translation": {
      "name": "ç¿»è¯‘",
      "desc": "å¤šè¯­è¨€äº’è¯‘ä¸æœ¬åœ°åŒ–",
      "auto": { "name": "æ™ºèƒ½ç¿»è¯‘", "desc": "è‡ªåŠ¨æ£€æµ‹è¯­è¨€å¹¶ç¿»è¯‘" },
      "toTarget": { "name": "æŒ‡å®šè¯­è¨€ç¿»è¯‘", "desc": "é€‰æ‹©ç›®æ ‡è¯­è¨€åç¿»è¯‘" },
      "explain": { "name": "ç¿»è¯‘å¹¶è§£é‡Š", "desc": "ç¿»è¯‘å¹¶é€å¥è§£é‡Šç”¨è¯" },
      "polish": { "name": "æœ¬åœ°åŒ–æ¶¦è‰²", "desc": "ä½¿ç¿»è¯‘æ›´åœ°é“è‡ªç„¶" },
      "compare": { "name": "å¤šç‰ˆæœ¬ç¿»è¯‘", "desc": "æä¾›å¤šä¸ªä¸åŒé£æ ¼è¯‘æœ¬" },
      "targetLang": "ç›®æ ‡è¯­è¨€",
      "lang": {
        "en": "è‹±è¯­",
        "zhCN": "ç®€ä½“ä¸­æ–‡",
        "ja": "æ—¥è¯­",
        "ko": "éŸ©è¯­",
        "fr": "æ³•è¯­",
        "de": "å¾·è¯­",
        "es": "è¥¿ç­ç‰™è¯­"
      }
    },
    "student": {
      "name": "å­¦ä¹ åŠ©æ‰‹",
      "desc": "çŸ¥è¯†å­¦ä¹ ã€ç¬”è®°æ•´ç†ã€æ¦‚å¿µç†è§£",
      "explain": { "name": "æ¦‚å¿µè§£é‡Š", "desc": "ç”¨é€šä¿—è¯­è¨€è§£é‡Šæ¦‚å¿µ", "hint": "è¯·è¾“å…¥è¦è§£é‡Šçš„æ¦‚å¿µ..." },
      "notes": { "name": "å­¦ä¹ ç¬”è®°", "desc": "å°†å†…å®¹æ•´ç†æˆç»“æ„åŒ–ç¬”è®°" },
      "flashcard": { "name": "çŸ¥è¯†å¡ç‰‡", "desc": "ä»å†…å®¹ä¸­æå– Q&A é—ªå¡" },
      "mindmap": { "name": "æ€ç»´å¯¼å›¾", "desc": "ç”Ÿæˆ Markdown æ ¼å¼æ€ç»´å¯¼å›¾" },
      "essayOutline": { "name": "ä½œæ–‡æçº²", "desc": "ç”Ÿæˆä½œæ–‡æçº²", "hint": "è¯·è¾“å…¥ä½œæ–‡é¢˜ç›®..." },
      "reading": { "name": "é˜…è¯»ç†è§£", "desc": "å¯¹æ–‡æœ¬è¿›è¡Œæ·±åº¦åˆ†æ" },
      "formula": { "name": "å…¬å¼æ¨å¯¼", "desc": "ç»™å‡ºæ•°å­¦å…¬å¼æ¨å¯¼è¿‡ç¨‹", "hint": "è¯·è¾“å…¥å…¬å¼åç§°æˆ–å†…å®¹..." },
      "compare": { "name": "çŸ¥è¯†å¯¹æ¯”", "desc": "è¡¨æ ¼å¯¹æ¯”ä¸¤ä¸ªæ¦‚å¿µå¼‚åŒ", "hint": "è¯·è¾“å…¥è¦å¯¹æ¯”çš„ä¸¤ä¸ªæ¦‚å¿µï¼ˆå¦‚ï¼šTCP vs UDPï¼‰..." }
    },
    "kids": {
      "name": "å°‘å„¿å¯è’™",
      "desc": "å„¿ç«¥æ•…äº‹ã€è¶£å‘³å­¦ä¹ ã€äº’åŠ¨æ¸¸æˆ",
      "story": { "name": "å„¿ç«¥æ•…äº‹", "desc": "æ ¹æ®å…³é”®è¯ç”Ÿæˆå„¿ç«¥æ•…äº‹", "hint": "è¯·è¾“å…¥æ•…äº‹å…³é”®è¯ï¼ˆå¦‚ï¼šå°å…”å­ æ£®æ— å†’é™©ï¼‰..." },
      "poem": { "name": "å„¿æ­Œç«¥è°£", "desc": "æ ¹æ®ä¸»é¢˜ç¼–å†™å„¿æ­Œ", "hint": "è¯·è¾“å…¥ä¸»é¢˜..." },
      "why": { "name": "åä¸‡ä¸ªä¸ºä»€ä¹ˆ", "desc": "AI å›ç­”å°æœ‹å‹çš„ä¸ºä»€ä¹ˆ" },
      "alphabet": { "name": "å­—æ¯å­¦ä¹ ", "desc": "äº¤äº’å¼å­—æ¯å’Œæ‹¼éŸ³æ•™å­¦" },
      "mathGame": { "name": "è¶£å‘³ç®—æœ¯", "desc": "äº’åŠ¨å‡ºé¢˜ç®—æœ¯æ¸¸æˆ" },
      "riddle": { "name": "çŒœè°œè¯­", "desc": "AI å‡ºè°œè¯­è®©å°æœ‹å‹çŒœ" },
      "drawText": { "name": "çœ‹å›¾è¯´è¯", "desc": "æè¿°åœºæ™¯è®© AI ç¼–æ•…äº‹", "hint": "è¯·æè¿°ä¸€ä¸ªåœºæ™¯..." },
      "knowledge": { "name": "ç™¾ç§‘é—®ç­”", "desc": "è‡ªç„¶ç§‘å­¦åŠ¨ç‰©ç™¾ç§‘äº’åŠ¨" }
    },
    "marketing": {
      "name": "è¥é”€æ–‡æ¡ˆ",
      "desc": "ç¤¾äº¤åª’ä½“ã€å¹¿å‘Šã€SEO æ–‡æ¡ˆç”Ÿæˆ",
      "xiaohongshu": { "name": "å°çº¢ä¹¦æ–‡æ¡ˆ", "desc": "ç”Ÿæˆç§è‰é£æ ¼æ–‡æ¡ˆ", "hint": "è¯·è¾“å…¥äº§å“æˆ–ä¸»é¢˜..." },
      "twitter": { "name": "Twitter/X å¸–å­", "desc": "ç”Ÿæˆæ¨ç‰¹é£æ ¼çŸ­æ–‡æ¡ˆ", "hint": "è¯·è¾“å…¥ä¸»é¢˜..." },
      "slogan": { "name": "å¹¿å‘Šæ ‡è¯­", "desc": "ä¸ºå“ç‰Œ/äº§å“ç”Ÿæˆå¹¿å‘Šæ ‡è¯­", "hint": "è¯·è¾“å…¥å“ç‰Œæˆ–äº§å“..." },
      "email": { "name": "è¥é”€é‚®ä»¶", "desc": "é…ç½®ç›®æ ‡äººç¾¤å’Œè¯­æ°”ç”Ÿæˆé‚®ä»¶" },
      "seoArticle": { "name": "SEO æ–‡ç« ", "desc": "æ ¹æ®å…³é”®è¯ç”Ÿæˆ SEO ä¼˜åŒ–æ–‡ç« ", "hint": "è¯·è¾“å…¥ç›®æ ‡å…³é”®è¯..." },
      "productDesc": { "name": "äº§å“æè¿°", "desc": "ç”Ÿæˆæœ‰å¸å¼•åŠ›çš„äº§å“æè¿°", "hint": "è¯·è¾“å…¥äº§å“ä¿¡æ¯..." },
      "product": "äº§å“/æœåŠ¡",
      "audience": "ç›®æ ‡äººç¾¤",
      "tone": "è¯­æ°”é£æ ¼",
      "tone.formal": "æ­£å¼",
      "tone.friendly": "å‹å¥½",
      "tone.urgent": "ç´§è¿«",
      "tone.humorous": "å¹½é»˜"
    },
    "professional": {
      "name": "èŒåœºåŠå…¬",
      "desc": "é‚®ä»¶ã€æŠ¥å‘Šã€ä¼šè®®çºªè¦",
      "email": { "name": "å•†åŠ¡é‚®ä»¶", "desc": "é…ç½®åœºæ™¯å’Œè¯­æ°”ç”Ÿæˆé‚®ä»¶" },
      "meeting": { "name": "ä¼šè®®çºªè¦", "desc": "å°†ç¬”è®°æ•´ç†æˆæ­£å¼ä¼šè®®çºªè¦" },
      "report": { "name": "å·¥ä½œæŠ¥å‘Š", "desc": "ç”Ÿæˆå‘¨æŠ¥/æœˆæŠ¥/å­£æŠ¥" },
      "review": { "name": "ä»£ç å®¡æŸ¥", "desc": "å®¡æŸ¥ä»£ç å¹¶æå‡ºæ”¹è¿›å»ºè®®" },
      "resume": { "name": "ç®€å†ä¼˜åŒ–", "desc": "ç”¨ STAR æ³•åˆ™ä¼˜åŒ–ç®€å†æè¿°" },
      "prd": { "name": "PRD æ–‡æ¡£", "desc": "ç”Ÿæˆäº§å“éœ€æ±‚æ–‡æ¡£", "hint": "è¯·è¾“å…¥åŠŸèƒ½æè¿°..." },
      "reportType": "æŠ¥å‘Šç±»å‹",
      "reportType.weekly": "å‘¨æŠ¥",
      "reportType.monthly": "æœˆæŠ¥",
      "reportType.quarterly": "å­£æŠ¥"
    },
    "personal": {
      "name": "ä¸ªäººæˆé•¿",
      "desc": "æ—¥è®°ã€ç›®æ ‡ç®¡ç†ã€å†³ç­–åˆ†æ",
      "journal": { "name": "æ—¥è®°åŠ©æ‰‹", "desc": "å¼•å¯¼å¼æ—¥è®°å†™ä½œ", "hint": "è¯·è¾“å…¥ä»Šå¤©æƒ³è®°å½•çš„äº‹æƒ…..." },
      "goal": { "name": "ç›®æ ‡åˆ†è§£", "desc": "å°†å¤§ç›®æ ‡åˆ†è§£ä¸ºå¯æ‰§è¡Œæ­¥éª¤", "hint": "è¯·è¾“å…¥ä½ çš„ç›®æ ‡..." },
      "habit": { "name": "ä¹ æƒ¯å…»æˆ", "desc": "åˆ¶å®šä¹ æƒ¯å…»æˆè®¡åˆ’", "hint": "è¯·è¾“å…¥æƒ³å…»æˆçš„ä¹ æƒ¯..." },
      "decision": { "name": "å†³ç­–åˆ†æ", "desc": "åˆ©å¼Šåˆ†æå¸®åŠ©åšå†³å®š", "hint": "è¯·æè¿°ä½ é¢ä¸´çš„é€‰æ‹©..." },
      "bookNotes": { "name": "è¯»ä¹¦ç¬”è®°", "desc": "æ•´ç†é€‰ä¸­å†…å®¹ä¸ºè¯»ä¹¦ç¬”è®°" }
    },
    "games_cn": {
      "name": "ä¸­æ–‡æ¸¸æˆ",
      "desc": "é£èŠ±ä»¤ã€æˆè¯­æ¥é¾™ã€çŒœè°œè¯­ç­‰æ–‡å­—æ¸¸æˆ",
      "feihualing": { "name": "é£èŠ±ä»¤", "desc": "è½®æµè¯´å«æŒ‡å®šå­—çš„è¯—å¥" },
      "chengyuChain": { "name": "æˆè¯­æ¥é¾™", "desc": "æœ«å­—æ¥é¦–å­—çš„æˆè¯­æ¥é¾™" },
      "riddle": { "name": "çŒœè°œè¯­", "desc": "AI å‡ºè°œé¢ï¼Œä½ çŒœè°œåº•" },
      "lanternRiddle": { "name": "çŒœç¯è°œ", "desc": "å­—è°œã€æ‹†å­—ç­‰ç¯è°œæŒ‘æˆ˜" },
      "poetryFill": { "name": "è¯—è¯å¡«ç©º", "desc": "å¤è¯—è¯è®°å¿†åŠ›è€ƒéªŒ" },
      "storyChain": { "name": "æ•…äº‹æ¥é¾™", "desc": "åŒæ–¹äº¤æ›¿ç»­å†™æ•…äº‹" },
      "characterGame": { "name": "çŒœå­—æ¸¸æˆ", "desc": "æ ¹æ®æè¿°çŒœæ±‰å­—" },
      "brainTeaser": { "name": "è„‘ç­‹æ€¥è½¬å¼¯", "desc": "è¶£å‘³è„‘ç­‹æ€¥è½¬å¼¯" },
      "couplet": { "name": "å¯¹è”", "desc": "AI å‡ºä¸Šè”ï¼Œä½ å¯¹ä¸‹è”" },
      "wordExplain": { "name": "ä½ è¯´æˆ‘çŒœ", "desc": "AI æè¿°è¯è¯­ä½ æ¥çŒœ" },
      "ancientText": { "name": "æ–‡è¨€æ–‡ç¿»è¯‘", "desc": "æ–‡è¨€æ–‡ç¿»è¯‘ç™½è¯æ–‡æŒ‘æˆ˜" },
      "homophone": { "name": "è°éŸ³æ¢—", "desc": "è°éŸ³åŒå…³åˆ›æ„æŒ‘æˆ˜" }
    },
    "games_en": {
      "name": "è‹±æ–‡æ¸¸æˆ",
      "desc": "Word Chain, Hangman, Trivia ç­‰è‹±æ–‡è¯­è¨€æ¸¸æˆ",
      "wordChain": { "name": "Word Chain", "desc": "Last letter starts next word" },
      "twentyQuestions": { "name": "20 Questions", "desc": "Guess the object in 20 yes/no questions" },
      "hangman": { "name": "Hangman", "desc": "Guess the word letter by letter" },
      "storyBuilder": { "name": "Story Builder", "desc": "Take turns building a story" },
      "wordAssociation": { "name": "Word Association", "desc": "Free association word chain" },
      "riddles": { "name": "Riddles", "desc": "Solve English riddles" },
      "trivia": { "name": "Trivia Quiz", "desc": "General knowledge questions" },
      "rhymeTime": { "name": "Rhyme Time", "desc": "Create stories with rhyming words" },
      "acronym": { "name": "Acronym Game", "desc": "Make up meanings for random acronyms" },
      "taboo": { "name": "Taboo", "desc": "Describe a word without using forbidden words" },
      "sentenceBuilder": { "name": "Sentence Builder", "desc": "Build the longest sentence with given words" },
      "emojiStory": { "name": "Emoji Story", "desc": "Tell stories using emojis" }
    },
    "quiz": {
      "name": "åˆ·é¢˜ç»ƒä¹ ",
      "desc": "AI å‡ºé¢˜è¯„åˆ†ï¼Œæ¶µç›–å„é¢†åŸŸ",
      "practice": { "name": "ä¸‡èƒ½åˆ·é¢˜", "desc": "é€‰æ‹©æ–¹å‘å’Œéš¾åº¦ï¼ŒAI å‡ºé¢˜ â†’ ç­”é¢˜ â†’ è¯„åˆ† â†’ ä¸‹ä¸€é¢˜" },
      "direction": "åˆ·é¢˜æ–¹å‘",
      "dir": {
        "programming": "ç¼–ç¨‹",
        "math": "æ•°å­¦",
        "english": "è‹±è¯­",
        "science": "ç§‘å­¦",
        "history": "å†å²",
        "interview": "é¢è¯•é¢˜",
        "custom": "è‡ªå®šä¹‰æ–¹å‘"
      },
      "difficulty": "éš¾åº¦",
      "diff": {
        "easy": "ç®€å•",
        "medium": "ä¸­ç­‰",
        "hard": "å›°éš¾"
      }
    }
  }
}
```

#### è‹±æ–‡ (en.json)

```json
{
  "templates": {
    "gallery": {
      "title": "AI Assistant",
      "search": "Search templates...",
      "all": "All",
      "back": "Back to categories"
    },
    "writing": {
      "name": "Writing",
      "desc": "AI-powered writing, editing, and summarization",
      "free": { "name": "Free Write", "desc": "Enter a topic and AI generates content", "hint": "Enter a writing topic or instructions..." },
      "continue": { "name": "Continue Writing", "desc": "Continue from the end of the document" },
      "outline": { "name": "Generate Outline", "desc": "Create an article outline", "hint": "Enter article topic..." },
      "summarize": { "name": "Summarize", "desc": "Summarize selected text or full document" },
      "improve": { "name": "Improve", "desc": "Enhance writing quality" },
      "simplify": { "name": "Simplify", "desc": "Simplify complex text" },
      "expand": { "name": "Expand", "desc": "Add more details and explanations" },
      "fixGrammar": { "name": "Fix Grammar", "desc": "Fix grammar and spelling errors" }
    },
    "translation": {
      "name": "Translation",
      "desc": "Multi-language translation and localization",
      "auto": { "name": "Smart Translate", "desc": "Auto-detect language and translate" },
      "toTarget": { "name": "Translate To...", "desc": "Choose target language and translate" },
      "explain": { "name": "Translate & Explain", "desc": "Translate with word-by-word explanation" },
      "polish": { "name": "Localize", "desc": "Make translations more natural" },
      "compare": { "name": "Multi-version", "desc": "Provide multiple translation styles" },
      "targetLang": "Target Language",
      "lang": {
        "en": "English",
        "zhCN": "Simplified Chinese",
        "ja": "Japanese",
        "ko": "Korean",
        "fr": "French",
        "de": "German",
        "es": "Spanish"
      }
    },
    "student": {
      "name": "Study Helper",
      "desc": "Learning, note-taking, concept understanding",
      "explain": { "name": "Explain Concept", "desc": "Explain a concept in simple terms", "hint": "Enter a concept to explain..." },
      "notes": { "name": "Study Notes", "desc": "Organize content into structured notes" },
      "flashcard": { "name": "Flashcards", "desc": "Extract Q&A flashcards from content" },
      "mindmap": { "name": "Mind Map", "desc": "Generate a Markdown mind map" },
      "essayOutline": { "name": "Essay Outline", "desc": "Generate an essay outline", "hint": "Enter essay topic..." },
      "reading": { "name": "Reading Analysis", "desc": "Deep analysis of text content" },
      "formula": { "name": "Formula Derivation", "desc": "Show math formula derivation steps", "hint": "Enter formula name or content..." },
      "compare": { "name": "Compare Concepts", "desc": "Compare two concepts side by side", "hint": "Enter two concepts (e.g., TCP vs UDP)..." }
    },
    "kids": {
      "name": "Kids Learning",
      "desc": "Stories, fun learning, interactive games",
      "story": { "name": "Kids Story", "desc": "Generate a story from keywords", "hint": "Enter story keywords (e.g., bunny forest adventure)..." },
      "poem": { "name": "Nursery Rhyme", "desc": "Create a rhyme about a topic", "hint": "Enter a topic..." },
      "why": { "name": "Why? Why? Why?", "desc": "AI answers endless 'why' questions" },
      "alphabet": { "name": "Alphabet Fun", "desc": "Interactive letter learning" },
      "mathGame": { "name": "Math Game", "desc": "Fun interactive arithmetic" },
      "riddle": { "name": "Riddles", "desc": "AI gives riddles for kids to solve" },
      "drawText": { "name": "Picture Talk", "desc": "Describe a scene, AI writes a story", "hint": "Describe a scene..." },
      "knowledge": { "name": "Fun Facts", "desc": "Nature, science, animal encyclopedia" }
    },
    "marketing": {
      "name": "Marketing",
      "desc": "Social media, ads, and SEO copywriting",
      "xiaohongshu": { "name": "Xiaohongshu Post", "desc": "Generate lifestyle-review style post", "hint": "Enter product or topic..." },
      "twitter": { "name": "Twitter/X Post", "desc": "Generate tweet-style content", "hint": "Enter topic..." },
      "slogan": { "name": "Ad Slogan", "desc": "Generate catchy brand slogans", "hint": "Enter brand or product..." },
      "email": { "name": "Marketing Email", "desc": "Configure audience and tone for email" },
      "seoArticle": { "name": "SEO Article", "desc": "Generate SEO-optimized content", "hint": "Enter target keywords..." },
      "productDesc": { "name": "Product Description", "desc": "Generate compelling product copy", "hint": "Enter product info..." },
      "product": "Product/Service",
      "audience": "Target Audience",
      "tone": "Tone",
      "tone.formal": "Formal",
      "tone.friendly": "Friendly",
      "tone.urgent": "Urgent",
      "tone.humorous": "Humorous"
    },
    "professional": {
      "name": "Professional",
      "desc": "Emails, reports, meeting notes",
      "email": { "name": "Business Email", "desc": "Configure scenario and tone for email" },
      "meeting": { "name": "Meeting Notes", "desc": "Organize notes into formal minutes" },
      "report": { "name": "Work Report", "desc": "Generate weekly/monthly/quarterly report" },
      "review": { "name": "Code Review", "desc": "Review code and suggest improvements" },
      "resume": { "name": "Resume Polish", "desc": "Optimize resume with STAR method" },
      "prd": { "name": "PRD Document", "desc": "Generate product requirements doc", "hint": "Enter feature description..." },
      "reportType": "Report Type",
      "reportType.weekly": "Weekly",
      "reportType.monthly": "Monthly",
      "reportType.quarterly": "Quarterly"
    },
    "personal": {
      "name": "Personal Growth",
      "desc": "Journaling, goals, decision making",
      "journal": { "name": "Journal Helper", "desc": "Guided journaling and reflection", "hint": "What happened today?..." },
      "goal": { "name": "Goal Breakdown", "desc": "Break goals into actionable steps", "hint": "Enter your goal..." },
      "habit": { "name": "Habit Builder", "desc": "Create a habit-building plan", "hint": "Enter the habit you want to build..." },
      "decision": { "name": "Decision Analysis", "desc": "Pros/cons analysis for decisions", "hint": "Describe your choices..." },
      "bookNotes": { "name": "Book Notes", "desc": "Organize content into reading notes" }
    },
    "games_cn": {
      "name": "Chinese Games",
      "desc": "Poetry games, idiom chains, riddles",
      "feihualing": { "name": "Poetry Challenge", "desc": "Take turns reciting poems with a given character" },
      "chengyuChain": { "name": "Idiom Chain", "desc": "Chain idioms by last/first character" },
      "riddle": { "name": "Riddles", "desc": "AI gives clues, you guess the answer" },
      "lanternRiddle": { "name": "Lantern Riddles", "desc": "Character-based riddle puzzles" },
      "poetryFill": { "name": "Poetry Fill-in", "desc": "Fill in missing words from poems" },
      "storyChain": { "name": "Story Chain", "desc": "Take turns continuing a story" },
      "characterGame": { "name": "Character Guess", "desc": "Guess the Chinese character from clues" },
      "brainTeaser": { "name": "Brain Teasers", "desc": "Fun brain teaser puzzles" },
      "couplet": { "name": "Couplets", "desc": "AI gives first line, you match it" },
      "wordExplain": { "name": "Word Charades", "desc": "AI describes, you guess the word" },
      "ancientText": { "name": "Classical Chinese", "desc": "Translate classical to modern Chinese" },
      "homophone": { "name": "Homophones", "desc": "Homophone pun challenge" }
    },
    "games_en": {
      "name": "English Games",
      "desc": "Word Chain, Hangman, Trivia and more",
      "wordChain": { "name": "Word Chain", "desc": "Last letter starts the next word" },
      "twentyQuestions": { "name": "20 Questions", "desc": "Guess the object in 20 yes/no questions" },
      "hangman": { "name": "Hangman", "desc": "Guess the word letter by letter" },
      "storyBuilder": { "name": "Story Builder", "desc": "Take turns building a story" },
      "wordAssociation": { "name": "Word Association", "desc": "Free association word chain" },
      "riddles": { "name": "Riddles", "desc": "Solve English riddles" },
      "trivia": { "name": "Trivia Quiz", "desc": "General knowledge questions" },
      "rhymeTime": { "name": "Rhyme Time", "desc": "Create stories with rhyming words" },
      "acronym": { "name": "Acronym Game", "desc": "Make up meanings for random acronyms" },
      "taboo": { "name": "Taboo", "desc": "Describe without using forbidden words" },
      "sentenceBuilder": { "name": "Sentence Builder", "desc": "Build the longest sentence with given words" },
      "emojiStory": { "name": "Emoji Story", "desc": "Tell stories using emojis" }
    },
    "quiz": {
      "name": "Quiz & Practice",
      "desc": "AI-generated questions with scoring",
      "practice": { "name": "Universal Quiz", "desc": "Choose subject and difficulty, AI quizzes you" },
      "direction": "Subject",
      "dir": {
        "programming": "Programming",
        "math": "Mathematics",
        "english": "English",
        "science": "Science",
        "history": "History",
        "interview": "Interview Prep",
        "custom": "Custom Subject"
      },
      "difficulty": "Difficulty",
      "diff": {
        "easy": "Easy",
        "medium": "Medium",
        "hard": "Hard"
      }
    }
  }
}
```

---

## UI è®¾è®¡

### 1. æ¨¡æ¿ç”»å»Š (TemplateGallery)

æ›¿æ¢ `AIChatPanel.svelte` ä¸­ç°æœ‰çš„æ¬¢è¿é¡µï¼ˆ`ai-welcome` divï¼‰ï¼Œåœ¨èŠå¤©ä¸ºç©ºæ—¶å±•ç¤ºæ¨¡æ¿ç”»å»Šã€‚

**å¸ƒå±€**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI åŠ©æ‰‹                      â”‚
â”‚  [æœç´¢æ¨¡æ¿...]               â”‚
â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âœ   â”‚ â”‚ ğŸŒ  â”‚ â”‚ ğŸ“š  â”‚   â”‚
â”‚  â”‚å†™ä½œ  â”‚ â”‚ç¿»è¯‘  â”‚ â”‚å­¦ä¹   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸŒˆ  â”‚ â”‚ ğŸ“¢  â”‚ â”‚ ğŸ’¼  â”‚   â”‚
â”‚  â”‚å°‘å„¿  â”‚ â”‚è¥é”€  â”‚ â”‚èŒåœº  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ²  â”‚ â”‚ ğŸ¯  â”‚ â”‚ ğŸ§   â”‚   â”‚
â”‚  â”‚ä¸­æ–‡  â”‚ â”‚è‹±æ–‡  â”‚ â”‚åˆ·é¢˜  â”‚   â”‚
â”‚  â”‚æ¸¸æˆ  â”‚ â”‚æ¸¸æˆ  â”‚ â”‚ç»ƒä¹   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ ğŸŒ±  â”‚                    â”‚
â”‚  â”‚ä¸ªäºº  â”‚                    â”‚
â”‚  â”‚æˆé•¿  â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ç‚¹å‡»åˆ†ç±»åå±•å¼€è¯¥åˆ†ç±»ä¸‹çš„æ¨¡æ¿åˆ—è¡¨ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† å†™ä½œè¾…åŠ©                   â”‚
â”‚                              â”‚
â”‚  âœ è‡ªç”±å†™ä½œ                   â”‚
â”‚    è¾“å…¥ä¸»é¢˜æˆ–è¦æ±‚ï¼ŒAIç”Ÿæˆæ–‡ç«    â”‚
â”‚                              â”‚
â”‚  â†’ ç»§ç»­å†™ä½œ                   â”‚
â”‚    ä»å½“å‰æ–‡æ¡£æœ«å°¾ç»­å†™          â”‚
â”‚                              â”‚
â”‚  ğŸ“‘ ç”Ÿæˆå¤§çº²                   â”‚
â”‚    è¾“å…¥ä¸»é¢˜ï¼Œç”Ÿæˆæ–‡ç« å¤§çº²       â”‚
â”‚                              â”‚
â”‚  ğŸ“‹ æ€»ç»“æ¦‚æ‹¬                   â”‚
â”‚    æ€»ç»“é€‰ä¸­æ–‡æœ¬æˆ–å…¨æ–‡è¦ç‚¹       â”‚
â”‚  ...                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. å‚æ•°é¢æ¿ (TemplateParamPanel)

å½“ç”¨æˆ·ç‚¹å‡» `parameterized` æˆ– `selection` ç±»å‹æ¨¡æ¿æ—¶ï¼Œåœ¨è¾“å…¥æ¡†ä¸Šæ–¹å¼¹å‡ºå‚æ•°é…ç½®é¢æ¿ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ§  ä¸‡èƒ½åˆ·é¢˜                  â”‚
â”‚                              â”‚
â”‚  åˆ·é¢˜æ–¹å‘: [ç¼–ç¨‹      â–¾]     â”‚
â”‚                              â”‚
â”‚  éš¾åº¦: â—‹ ç®€å•  â— ä¸­ç­‰  â—‹ å›°éš¾â”‚
â”‚                              â”‚
â”‚  [å¼€å§‹åˆ·é¢˜]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

å½“ç”¨æˆ·ç‚¹å‡» `input` ç±»å‹æ¨¡æ¿æ—¶ï¼Œè¾“å…¥æ¡†è·å¾—ç„¦ç‚¹å¹¶æ˜¾ç¤ºå¯¹åº” hintï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¯·è¾“å…¥å†™ä½œä¸»é¢˜æˆ–è¦æ±‚...      â”‚
â”‚  [å‘é€]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. äº¤äº’çŠ¶æ€æœº

```
idle (æ¬¢è¿é¡µ / æ¨¡æ¿ç”»å»Š)
  â”‚
  â”œâ”€â”€ ç‚¹å‡» auto æ¨¡æ¿ â”€â”€â”€â”€â”€â”€> executing â†’ chatting
  â”œâ”€â”€ ç‚¹å‡» input æ¨¡æ¿ â”€â”€â”€â”€â”€> inputting â†’ executing â†’ chatting
  â”œâ”€â”€ ç‚¹å‡» selection æ¨¡æ¿ â”€â”€> selecting â†’ executing â†’ chatting
  â”œâ”€â”€ ç‚¹å‡» parameterized â”€â”€> configuring â†’ executing â†’ chatting
  â””â”€â”€ ç‚¹å‡» interactive â”€â”€â”€â”€> executing â†’ interactive_chatting
                                          â†• (å¤šè½®è‡ªç”±å¯¹è¯)
```

---

## æ¶æ„è®¾è®¡

### æ•°æ®æµ

```
builtin-templates.ts (71 templates JSON)
         â”‚
         â–¼
    registry.ts â”€â”€â”€â”€ getCategories() / getTemplatesByCategory() / searchTemplates()
         â”‚
         â–¼
    engine.ts â”€â”€â”€â”€â”€â”€ resolveContent() / interpolate() / executeTemplate()
         â”‚
         â–¼
    AIChatPanel.svelte â”€â”€ sendChatMessage() / executeAICommand()
         â”‚                     (å¤ç”¨ç°æœ‰ AI åŸºç¡€è®¾æ–½)
         â–¼
    ai-service.ts â†’ providers.ts â†’ Rust ai_proxy
```

### æµç¨‹å¼•æ“æ ¸å¿ƒé€»è¾‘

```typescript
// src/lib/services/ai/templates/engine.ts

import type { AITemplate, TemplateContext } from './types';
import { get } from 'svelte/store';
import { t, currentLocale } from '$lib/i18n';

/**
 * æ ¹æ® contentSource è§£æç¼–è¾‘å™¨å†…å®¹
 */
export function resolveContent(
  template: AITemplate,
  documentContent: string,
  selectedText: string,
): string {
  switch (template.contentSource) {
    case 'none': return '';
    case 'document': return documentContent.slice(-3000);
    case 'selection': return selectedText;
    case 'document_or_selection':
      return selectedText || documentContent.slice(-3000);
  }
}

/**
 * æ‰§è¡Œæ¨¡æ¿ï¼šæ„å»º system/user messages
 * è¿”å› { systemPrompt, userMessage } ä¾› sendChatMessage ä½¿ç”¨
 */
export function buildTemplateMessages(
  template: AITemplate,
  ctx: TemplateContext,
): { systemPrompt: string; userMessage: string } {
  const systemPrompt = template.systemPrompt;
  const userMessage = interpolate(template.userPromptTemplate, ctx);
  return { systemPrompt, userMessage };
}
```

### å‘åå…¼å®¹

- **ä¿ç•™ `/` å‘½ä»¤é¢æ¿**: åŸæœ‰ `AI_COMMANDS` æ•°ç»„ä¸åˆ é™¤ï¼Œä½†æ ‡è®°ä¸º legacy
- **æ¨¡æ¿ç³»ç»Ÿè¦†ç›–**: åŸæœ‰ 10 ä¸ªå‘½ä»¤å…¨éƒ¨åœ¨ `writing` å’Œ `translation` åˆ†ç±»ä¸­æœ‰å¯¹åº”æ¨¡æ¿
- **æ¸è¿›è¿ç§»**: ç¬¬ä¸€é˜¶æ®µæ¨¡æ¿ç”»å»Šæ›¿æ¢æ¬¢è¿é¡µï¼›ç¬¬äºŒé˜¶æ®µå¯é€‰æ›¿æ¢ `/` å‘½ä»¤é¢æ¿

---

## æ–°å¢/ä¿®æ”¹æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶

| æ–‡ä»¶ | å¤§å°ä¼°ç®— | è¯´æ˜ |
|------|---------|------|
| `src/lib/services/ai/templates/types.ts` | ~2 KB | é¢†åŸŸæ¨¡å‹ç±»å‹å®šä¹‰ |
| `src/lib/services/ai/templates/engine.ts` | ~3 KB | æ’å€¼å¼•æ“ + å†…å®¹è§£æ + æ¨¡æ¿æ‰§è¡Œ |
| `src/lib/services/ai/templates/registry.ts` | ~2 KB | æ¨¡æ¿æ³¨å†Œã€æŸ¥è¯¢ã€æœç´¢ |
| `src/lib/services/ai/templates/builtin-templates.ts` | ~15 KB | 71 ä¸ªå†…ç½®æ¨¡æ¿å®šä¹‰ï¼ˆJSONï¼‰ |
| `src/lib/services/ai/templates/index.ts` | ~0.3 KB | æ¨¡å—å¯¼å‡º |
| `src/lib/components/ai/TemplateGallery.svelte` | ~8 KB | æ¨¡æ¿ç”»å»Š UIï¼ˆåˆ†ç±»ç½‘æ ¼ + æ¨¡æ¿åˆ—è¡¨ï¼‰ |
| `src/lib/components/ai/TemplateParamPanel.svelte` | ~4 KB | å‚æ•°é…ç½®é¢æ¿ UI |

### ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ”¹åŠ¨ |
|------|------|
| `src/lib/components/ai/AIChatPanel.svelte` | æ›¿æ¢ `ai-welcome` åŒºåŸŸä¸º `TemplateGallery`ï¼›æ–°å¢ `TemplateParamPanel`ï¼›æ·»åŠ æ¨¡æ¿æ‰§è¡Œé€»è¾‘ |
| `src/lib/i18n/locales/zh-CN.json` | æ·»åŠ  `templates` å‘½åç©ºé—´ (~300 ä¸ª key) |
| `src/lib/i18n/locales/en.json` | æ·»åŠ  `templates` å‘½åç©ºé—´ (~300 ä¸ª key) |
| `src/lib/services/ai/index.ts` | å¯¼å‡º templates æ¨¡å— |

### ä¸æ”¹åŠ¨çš„æ–‡ä»¶

| æ–‡ä»¶ | åŸå›  |
|------|------|
| `src/lib/services/ai/ai-service.ts` | æ¨¡æ¿å¼•æ“å¤ç”¨ `sendChatMessage` / `executeAICommand`ï¼Œæ— éœ€ä¿®æ”¹ |
| `src/lib/services/ai/providers.ts` | AI è¯·æ±‚é€šé“ä¸å˜ |
| `src-tauri/src/**` | æ—  Rust ä¾§æ”¹åŠ¨ |
| `src/lib/services/ai/types.ts` | åŸæœ‰ `AICommand` ç±»å‹ä¿ç•™å‘åå…¼å®¹ |

### åŒ…å¤§å°å½±å“

| æ–°å¢æ¨¡å— | é¢„ä¼°å¤§å° | gzip å |
|---------|---------|---------|
| builtin-templates.ts (JSON) | ~15 KB | ~4 KB |
| engine.ts + registry.ts + types.ts | ~7 KB | ~2.5 KB |
| TemplateGallery.svelte | ~8 KB | ~3 KB |
| TemplateParamPanel.svelte | ~4 KB | ~1.5 KB |
| i18n å¢é‡ (zh-CN + en) | ~20 KB | ~5 KB |
| **åˆè®¡** | **~54 KB** | **~16 KB** |

å¯¹æ¯”å½“å‰ä¸»åŒ… ~1,859 KBï¼Œå¢é‡çº¦ **3%**ï¼ˆgzip å <1%ï¼‰ã€‚

---

## å®æ–½è®¡åˆ’

### é˜¶æ®µä¸€ï¼šæ ¸å¿ƒåŸºç¡€ï¼ˆ1-2å¤©ï¼‰

1. åˆ›å»º `templates/types.ts` â€” ç±»å‹å®šä¹‰
2. åˆ›å»º `templates/engine.ts` â€” æ’å€¼å¼•æ“ + å†…å®¹è§£æ
3. åˆ›å»º `templates/registry.ts` â€” æ¨¡æ¿æ³¨å†Œä¸æŸ¥è¯¢
4. åˆ›å»º `templates/builtin-templates.ts` â€” å†™ä½œ + ç¿»è¯‘åˆ†ç±»ï¼ˆ13 ä¸ªæ¨¡æ¿ï¼Œæ›¿æ¢åŸæœ‰åŠŸèƒ½ï¼‰
5. æ›´æ–° i18n JSON â€” å†™ä½œ + ç¿»è¯‘ç›¸å…³ key

### é˜¶æ®µäºŒï¼šUI ç»„ä»¶ï¼ˆ1-2å¤©ï¼‰

6. åˆ›å»º `TemplateGallery.svelte` â€” åˆ†ç±»ç½‘æ ¼ + æ¨¡æ¿åˆ—è¡¨
7. åˆ›å»º `TemplateParamPanel.svelte` â€” å‚æ•°é…ç½®é¢æ¿
8. ä¿®æ”¹ `AIChatPanel.svelte` â€” é›†æˆç”»å»Š + å‚æ•°é¢æ¿
9. ä¿®å¤ç©ºæ¶ˆæ¯ Bug â€” æ¨¡æ¿æ‰§è¡Œå‰æ ¡éªŒ content éç©º

### é˜¶æ®µä¸‰ï¼šå®Œæ•´æ¨¡æ¿åº“ï¼ˆ1-2å¤©ï¼‰

10. æ·»åŠ å­¦ä¹  + å°‘å„¿ + è¥é”€ + èŒåœº + ä¸ªäººåˆ†ç±»ï¼ˆ33 ä¸ªæ¨¡æ¿ï¼‰
11. æ·»åŠ ä¸­æ–‡æ¸¸æˆ + è‹±æ–‡æ¸¸æˆåˆ†ç±»ï¼ˆ24 ä¸ªæ¨¡æ¿ï¼‰
12. æ·»åŠ åˆ·é¢˜ç»ƒä¹ ï¼ˆ1 ä¸ªä¸‡èƒ½æ¨¡æ¿ï¼‰
13. å®Œå–„ i18n â€” å…¨éƒ¨åˆ†ç±»çš„ä¸­è‹±æ–‡ç¿»è¯‘

### é˜¶æ®µå››ï¼šéªŒè¯ä¸æ‰“ç£¨ï¼ˆ1å¤©ï¼‰

14. `pnpm check` â€” TypeScript ç¼–è¯‘é€šè¿‡
15. å…¨åˆ†ç±»åŠŸèƒ½æµ‹è¯•
16. å¤šè¯­è¨€åˆ‡æ¢æµ‹è¯•ï¼ˆä¸­/è‹±ï¼‰
17. å‘åå…¼å®¹éªŒè¯ï¼ˆ`/` å‘½ä»¤é¢æ¿ä»å¯ç”¨ï¼‰

---

## éªŒè¯æ–¹æ¡ˆ

### ç¼–è¯‘éªŒè¯

- [ ] `pnpm check` â€” 0 ä¸ª TS é”™è¯¯
- [ ] `cd src-tauri && cargo check` â€” ç¼–è¯‘é€šè¿‡ï¼ˆæ—  Rust æ”¹åŠ¨ï¼Œç¡®è®¤ä¸é€€åŒ–ï¼‰

### åŠŸèƒ½éªŒè¯

- [ ] æ¨¡æ¿ç”»å»Šï¼šæ‰“å¼€ AI é¢æ¿ â†’ æ˜¾ç¤º 10 ä¸ªåˆ†ç±»å›¾æ ‡
- [ ] åˆ†ç±»å±•å¼€ï¼šç‚¹å‡»åˆ†ç±» â†’ å±•ç¤ºè¯¥åˆ†ç±»ä¸‹æ‰€æœ‰æ¨¡æ¿
- [ ] æœç´¢ï¼šè¾“å…¥å…³é”®è¯ â†’ è·¨åˆ†ç±»æœç´¢åŒ¹é…æ¨¡æ¿

#### æŒ‰ FlowType éªŒè¯

- [ ] **auto**: ç‚¹å‡»ã€Œç»§ç»­å†™ä½œã€â†’ æ— éœ€è¾“å…¥ â†’ è‡ªåŠ¨è·å–æ–‡æ¡£å†…å®¹ â†’ å‘é€ AI â†’ æ”¶åˆ°å›å¤
- [ ] **auto + selection**: é€‰ä¸­æ–‡æœ¬ â†’ ç‚¹å‡»ã€Œæ¶¦è‰²ä¼˜åŒ–ã€â†’ AI åŸºäºé€‰ä¸­æ–‡æœ¬å›å¤
- [ ] **input**: ç‚¹å‡»ã€Œè‡ªç”±å†™ä½œã€â†’ è¾“å…¥æ¡†æ˜¾ç¤º hint â†’ è¾“å…¥å†…å®¹ â†’ å‘é€ â†’ AI å›å¤
- [ ] **selection**: é€‰ä¸­æ–‡æœ¬ â†’ ç‚¹å‡»ã€ŒæŒ‡å®šè¯­è¨€ç¿»è¯‘ã€â†’ é€‰æ‹©ç›®æ ‡è¯­è¨€ â†’ å‘é€ â†’ æ”¶åˆ°ç¿»è¯‘
- [ ] **parameterized**: ç‚¹å‡»ã€Œä¸‡èƒ½åˆ·é¢˜ã€â†’ é…ç½®æ–¹å‘+éš¾åº¦ â†’ ç‚¹å‡»å¼€å§‹ â†’ AI å‡ºç¬¬ä¸€é¢˜
- [ ] **interactive**: ç‚¹å‡»ã€Œé£èŠ±ä»¤ã€â†’ AI å‘èµ·æ¸¸æˆ â†’ ç”¨æˆ·å›ç­” â†’ AI åˆ¤å®š â†’ ç»§ç»­å¯¹è¯

#### ç©ºæ¶ˆæ¯ä¿®å¤éªŒè¯

- [ ] æ— æ–‡æ¡£å†…å®¹æ—¶ç‚¹å‡»ã€Œæ€»ç»“æ¦‚æ‹¬ã€â†’ æç¤ºç”¨æˆ·éœ€è¦å†…å®¹ï¼ˆä¸å‘é€ç©ºæ¶ˆæ¯ï¼‰
- [ ] æ— é€‰ä¸­æ–‡æœ¬æ—¶ç‚¹å‡»ã€Œæ¶¦è‰²ä¼˜åŒ–ã€â†’ æç¤ºç”¨æˆ·éœ€è¦é€‰ä¸­æ–‡æœ¬

#### i18n éªŒè¯

- [ ] ä¸­æ–‡ç¯å¢ƒï¼šæ‰€æœ‰åˆ†ç±»åã€æ¨¡æ¿åã€æè¿°å‡ä¸ºä¸­æ–‡
- [ ] è‹±æ–‡ç¯å¢ƒï¼šæ‰€æœ‰åˆ†ç±»åã€æ¨¡æ¿åã€æè¿°å‡ä¸ºè‹±æ–‡
- [ ] åˆ‡æ¢è¯­è¨€åç”»å»Šå†…å®¹å®æ—¶æ›´æ–°

#### å‘åå…¼å®¹

- [ ] è¾“å…¥æ¡†ä¸­è¾“å…¥ `/` â†’ ä»å¼¹å‡ºå‘½ä»¤é¢æ¿
- [ ] `/write`ã€`/translate` ç­‰åŸæœ‰å‘½ä»¤æ­£å¸¸ä½¿ç”¨
